  // ðŸ‘‡ TAG_POS type - Click words and tag them
  if (challenge.type === "TAG_POS") {
    const words = challenge.words || [];
    const posOptions = challenge.posOptions || [];

    const handleWordClick = (wordId: number) => {
      if (disabled) return;

      // If clicking already matched word, deselect it
      if (taggedWords?.[wordId]) {
        removeMatch(wordId);
        return;
      }

      // If this word is already selected, deselect it
      if (selectedWord === wordId) {
        setSelectedWord(null);
        return;
      }

      setSelectedWord(wordId);

      // If a POS is already selected, create the match
      if (selectedPos !== null) {
        const posText = posOptions.find((p: any) => p.id === selectedPos)?.text;
        if (posText) {
          onTag?.({ ...taggedWords, [wordId]: posText });
          setSelectedWord(null);
          setSelectedPos(null);
        }
      }
    };

    const handlePosClick = (posId: number, posText: string) => {
      if (disabled) return;

      // Check if this POS is already used in a match
      const matchedWordId = Object.entries(taggedWords || {}).find(
        ([_, tag]) => tag === posText
      )?.[0];

      // If clicking already matched POS, remove that match
      if (matchedWordId) {
        removeMatch(Number(matchedWordId));
        return;
      }

      // If this POS is already selected, deselect it
      if (selectedPos === posId) {
        setSelectedPos(null);
        return;
      }

      setSelectedPos(posId);

      // If a word is already selected, create the match
      if (selectedWord !== null) {
        onTag?.({ ...taggedWords, [selectedWord]: posText });
        setSelectedWord(null);
        setSelectedPos(null);
      }
    };

    const removeMatch = (wordId: number) => {
      const newTagged = { ...taggedWords };
      delete newTagged[wordId];
      onTag?.(newTagged);
      setSelectedWord(null);
      setSelectedPos(null);
    };

    return (
      <div className="flex flex-col gap-6">
        <div className="grid grid-cols-2 gap-6">
          {/* LEFT COLUMN: Words */}
          <div className="space-y-3">
            <p className="text-sm font-semibold text-neutral-700 mb-3">Words</p>
            {words.map((word: any) => {
              const isMatched = !!taggedWords?.[word.id];
              const isSelected = selectedWord === word.id;

              return (
                <button
                  key={word.id}
                  onClick={() => handleWordClick(word.id)}
                  disabled={disabled}
                  className={cn(
                    "w-full p-4 rounded-xl border-2 text-left font-medium transition-all",
                    isMatched
                      ? "bg-green-50 border-green-500 text-green-700"
                      : isSelected
                      ? "bg-purple-100 border-purple-500 text-purple-900 scale-105 shadow-lg"
                      : "bg-white border-neutral-300 hover:border-purple-300 hover:bg-purple-50",
                    disabled && "opacity-50 cursor-not-allowed"
                  )}
                >
                  <span className="text-lg">{word.word}</span>
                </button>
              );
            })}
          </div>

          {/* RIGHT COLUMN: Parts of Speech */}
          <div className="space-y-3">
            <p className="text-sm font-semibold text-neutral-700 mb-3">
              Parts of Speech
            </p>
            {posOptions.map((pos: any) => {
              // Check if this POS is matched to any word
              const matchedWordId = Object.entries(taggedWords || {}).find(
                ([_, tag]) => tag === pos.text
              )?.[0];
              const isMatched = !!matchedWordId;
              const isSelected = selectedPos === pos.id;

              return (
                <button
                  key={pos.id}
                  onClick={() => handlePosClick(pos.id, pos.text)}
                  disabled={disabled}
                  className={cn(
                    "w-full p-4 rounded-xl border-2 text-center font-medium transition-all",
                    isMatched
                      ? "bg-green-50 border-green-500 text-green-700"
                      : isSelected
                      ? "bg-purple-100 border-purple-500 text-purple-900 scale-105 shadow-lg"
                      : "bg-white border-neutral-300 hover:border-purple-300 hover:bg-purple-50",
                    disabled && "cursor-not-allowed"
                  )}
                >
                  {pos.text}
                </button>
              );
            })}
          </div>
        </div>

        <p className="text-sm text-center text-neutral-500">
          ðŸ’¡ Click a word, then click its part of speech to match them
        </p>
      </div>
    );
  }

// ...existing code...